(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49491,       1305]
NotebookOptionsPosition[     46162,       1188]
NotebookOutlinePosition[     46498,       1203]
CellTagsIndexPosition[     46455,       1200]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"delta", "=", 
  RowBox[{"1.", " ", 
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]]}]}]], "Input",
 CellChangeTimes->{{3.6671500756460667`*^9, 3.667150110820114*^9}}],

Cell[BoxData["1.`*^-6"], "Output",
 CellChangeTimes->{{3.667150083359858*^9, 3.6671501112695913`*^9}, 
   3.667151691056924*^9, 3.673852504239894*^9, 3.6738525371135683`*^9, 
   3.6738814975031676`*^9, 3.674281566739134*^9, 3.6742817727681355`*^9, 
   3.6742818119417667`*^9, 3.6742818676412425`*^9, 3.6742819125829563`*^9, {
   3.6742819968705854`*^9, 3.6742820214736156`*^9}, 3.6742820703770323`*^9, 
   3.6742822444603806`*^9, 3.674282286939005*^9, {3.6742858052214785`*^9, 
   3.674285816074456*^9}, 3.6742927930219755`*^9, 3.6742929103726254`*^9, 
   3.8143706856335773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<./\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.814370667771009*^9, 3.814370676822051*^9}}],

Cell[BoxData["\<\"/home/users/alamman4/Desktop/Mathematicacoll\"\>"], "Output",
 CellChangeTimes->{
  3.6671482294088182`*^9, 3.667151691181923*^9, 3.6738525059430423`*^9, 
   3.673852537238591*^9, 3.6738815012786827`*^9, 3.674281566817276*^9, 
   3.674281772861888*^9, 3.6742818120198965`*^9, 3.674281867719349*^9, 
   3.674281912661097*^9, {3.674281996964334*^9, 3.6742820215517626`*^9}, 
   3.6742820704864087`*^9, 3.674282244538515*^9, 3.674282287017131*^9, {
   3.674285805315545*^9, 3.6742858161625376`*^9}, 3.6742927934567842`*^9, 
   3.6742929104736977`*^9, 3.814370685696273*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"chr", "=", 
   RowBox[{"OpenRead", "[", "\"\<sigma02.vasp\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dumiChar", "=", 
   RowBox[{"Read", "[", 
    RowBox[{"chr", ",", "Word"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"factMult", "=", 
   RowBox[{"Read", "[", 
    RowBox[{"chr", ",", "Real"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "3"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "3"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"j", ",", "i"}], "]"}], "=", 
         RowBox[{"Read", "[", 
          RowBox[{"chr", ",", "Real"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "++"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dumiChar", "=", 
   RowBox[{"Read", "[", 
    RowBox[{"chr", ",", "Word"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dumiChar", "=", 
   RowBox[{"Read", "[", 
    RowBox[{"chr", ",", "Word"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numAtoms1", "=", 
   RowBox[{"Read", "[", 
    RowBox[{"chr", ",", "Number"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numAtoms2", "=", 
   RowBox[{"Read", "[", 
    RowBox[{"chr", ",", "Number"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dumiChar", "=", 
  RowBox[{"Read", "[", 
   RowBox[{"chr", ",", "Word"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "numAtoms1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"xP", "[", "i", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Read", "[", 
         RowBox[{"chr", ",", "Real"}], "]"}], ",", 
        RowBox[{"Read", "[", 
         RowBox[{"chr", ",", "Real"}], "]"}], ",", 
        RowBox[{"Read", "[", 
         RowBox[{"chr", ",", "Real"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "++"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "numAtoms2"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"xM", "[", "i", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Read", "[", 
         RowBox[{"chr", ",", "Real"}], "]"}], ",", 
        RowBox[{"Read", "[", 
         RowBox[{"chr", ",", "Real"}], "]"}], ",", 
        RowBox[{"Read", "[", 
         RowBox[{"chr", ",", "Real"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "++"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Close", "[", "chr", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.667148243451959*^9, 3.667148288631321*^9}}],

Cell[BoxData["\<\"Direct\"\>"], "Output",
 CellChangeTimes->{
  3.667148288990855*^9, 3.6671516911975727`*^9, 3.6738525066461782`*^9, 
   3.673852537254197*^9, 3.673881502041484*^9, 3.674281567473518*^9, 
   3.674281704958192*^9, 3.674281772861888*^9, 3.6742818120355024`*^9, 
   3.674281867734995*^9, 3.674281912661097*^9, {3.674281996995604*^9, 
   3.6742820215673914`*^9}, 3.6742820705176587`*^9, 3.6742822445541363`*^9, 
   3.674282287032757*^9, {3.6742858053305564`*^9, 3.6742858161725273`*^9}, 
   3.674292793513828*^9, 3.6742929104867067`*^9, 3.814370685721525*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "2"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "2"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"3", ",", "1"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"3", ",", "2"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"6.61744351`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "3.820582792`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "9.358478359`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6671483586590915`*^9, 3.6671516912131753`*^9, {3.6738525083024483`*^9, 
   3.6738525372698407`*^9}, 3.673881503413453*^9, 3.6742815680672736`*^9, 
   3.6742817057081847`*^9, 3.6742817728775125`*^9, 3.6742818120511274`*^9, 
   3.67428186775062*^9, 3.6742819126923413`*^9, {3.674281996995604*^9, 
   3.674282021582992*^9}, 3.6742820705333033`*^9, 3.6742822445697546`*^9, 
   3.6742822870483837`*^9, {3.674285805346566*^9, 3.674285816189537*^9}, 
   3.67429279353684*^9, 3.6742929105037384`*^9, 3.81437068574972*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Anew", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"A", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"4", 
     RowBox[{"A", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6671483973748393`*^9, 3.6671484127633915`*^9}, 
   3.667148830827772*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"6.61744351`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "3.820582792`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "37.433913436`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.667148415129447*^9, 3.6671488312759976`*^9, 3.667151691228799*^9, {
   3.673852512658043*^9, 3.6738525372698407`*^9}, 3.673881504618778*^9, 
   3.6742815691454315`*^9, 3.6742817062707*^9, 3.6742817728931465`*^9, 
   3.67428181206677*^9, 3.6742818677662244`*^9, 3.6742819126923413`*^9, {
   3.674281997011214*^9, 3.6742820215986176`*^9}, 3.6742820705489097`*^9, 
   3.6742822445853977`*^9, 3.6742822870483837`*^9, {3.6742858053555727`*^9, 
   3.674285816202548*^9}, 3.67429279355035*^9, 3.6742929105142264`*^9, 
   3.814370685772354*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xxP", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xxM", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"iz", "=", 
    RowBox[{"-", "5"}]}], ",", 
   RowBox[{"iz", "\[LessEqual]", "5"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "numAtoms1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xP", "[", "i", "]"}], "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "iz"}], "}"}]}], ")"}], ".", "A"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tmpInv", "=", 
        RowBox[{"tmp", ".", 
         RowBox[{"Inverse", "[", "Anew", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.5"}], "\[LessEqual]", 
          RowBox[{"tmpInv", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{"xxP", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"xxP", ",", "tmpInv"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xM", "[", "i", "]"}], "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "iz"}], "}"}]}], ")"}], ".", "A"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tmpInv", "=", 
        RowBox[{"tmp", ".", 
         RowBox[{"Inverse", "[", "Anew", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"0", "\[LessEqual]", 
          RowBox[{"tmpInv", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "<", "0.5"}], ",", 
         RowBox[{"xxM", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"xxM", ",", "tmpInv"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "++"}]}]}], "]"}], ";", 
    RowBox[{"iz", "++"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6671483027492023`*^9, 3.6671485586331077`*^9}, {
  3.6671485967661033`*^9, 3.667148606733255*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dimensions", "[", "xxP", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "xxM", "]"}]}], "Input",
 CellChangeTimes->{{3.667148516490335*^9, 3.6671485238251643`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"24", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.667148524108014*^9, 3.667148560369358*^9}, {
   3.667148600072486*^9, 3.6671486077366505`*^9}, 3.667148833299735*^9, 
   3.667151691275696*^9, 3.673852537316745*^9, 3.673881510970525*^9, 
   3.6742815710985827`*^9, {3.674281701755024*^9, 3.6742817110746565`*^9}, 
   3.674281772924395*^9, 3.6742818120980225`*^9, 3.674281867797489*^9, 
   3.6742819127236037`*^9, {3.67428199704246*^9, 3.67428202162987*^9}, 
   3.6742820705801744`*^9, 3.6742822446010075`*^9, 3.6742822870952587`*^9, {
   3.674285805397602*^9, 3.674285816242575*^9}, 3.6742927935898776`*^9, 
   3.6742929105562763`*^9, 3.814370685798757*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"24", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.667148524108014*^9, 3.667148560369358*^9}, {
   3.667148600072486*^9, 3.6671486077366505`*^9}, 3.667148833299735*^9, 
   3.667151691275696*^9, 3.673852537316745*^9, 3.673881510970525*^9, 
   3.6742815710985827`*^9, {3.674281701755024*^9, 3.6742817110746565`*^9}, 
   3.674281772924395*^9, 3.6742818120980225`*^9, 3.674281867797489*^9, 
   3.6742819127236037`*^9, {3.67428199704246*^9, 3.67428202162987*^9}, 
   3.6742820705801744`*^9, 3.6742822446010075`*^9, 3.6742822870952587`*^9, {
   3.674285805397602*^9, 3.674285816242575*^9}, 3.6742927935898776`*^9, 
   3.6742929105562763`*^9, 3.814370685799567*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xxP", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.66714856687716*^9, 3.6671485716940556`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", 
      RowBox[{"-", "0.5`"}]},
     {"0.`", "0.`", 
      RowBox[{"-", "0.31250000000000006`"}]},
     {"0.333333`", "0.`", 
      RowBox[{"-", "0.479166675`"}]},
     {"0.333333`", "0.`", 
      RowBox[{"-", "0.41666675000000003`"}]},
     {"0.666667`", "0.`", 
      RowBox[{"-", "0.39583325`"}]},
     {"0.666667`", "0.`", 
      RowBox[{"-", "0.33333325`"}]},
     {"0.166667`", "0.5`", 
      RowBox[{"-", "0.39583325`"}]},
     {"0.166667`", "0.5`", 
      RowBox[{"-", "0.33333325`"}]},
     {"0.5`", "0.5`", 
      RowBox[{"-", "0.5`"}]},
     {"0.5`", "0.5`", 
      RowBox[{"-", "0.31250000000000006`"}]},
     {"0.833333`", "0.5`", 
      RowBox[{"-", "0.479166675`"}]},
     {"0.833333`", "0.5`", 
      RowBox[{"-", "0.41666675000000003`"}]},
     {"0.`", "0.`", 
      RowBox[{"-", "0.25`"}]},
     {"0.`", "0.`", 
      RowBox[{"-", "0.0625`"}]},
     {"0.333333`", "0.`", 
      RowBox[{"-", "0.229166675`"}]},
     {"0.333333`", "0.`", 
      RowBox[{"-", "0.16666675`"}]},
     {"0.666667`", "0.`", 
      RowBox[{"-", "0.14583325`"}]},
     {"0.666667`", "0.`", 
      RowBox[{"-", "0.08333325`"}]},
     {"0.166667`", "0.5`", 
      RowBox[{"-", "0.14583325`"}]},
     {"0.166667`", "0.5`", 
      RowBox[{"-", "0.08333325`"}]},
     {"0.5`", "0.5`", 
      RowBox[{"-", "0.25`"}]},
     {"0.5`", "0.5`", 
      RowBox[{"-", "0.0625`"}]},
     {"0.833333`", "0.5`", 
      RowBox[{"-", "0.229166675`"}]},
     {"0.833333`", "0.5`", 
      RowBox[{"-", "0.16666675`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6671485720254464`*^9, 3.6671486086003647`*^9}, 
   3.6671488345551157`*^9, 3.6671516912913284`*^9, 3.6738525373323216`*^9, 
   3.673881511925584*^9, 3.674281577583029*^9, {3.674281702442514*^9, 
   3.6742817118803654`*^9}, 3.6742817729400125`*^9, 3.67428181211364*^9, 
   3.674281867813136*^9, 3.6742819127392073`*^9, {3.6742819970580883`*^9, 
   3.6742820216454954`*^9}, 3.6742820705801744`*^9, 3.674282244616666*^9, 
   3.674282287110903*^9, {3.6742858054116125`*^9, 3.674285816261588*^9}, 
   3.6742927936314087`*^9, 3.674292910571767*^9, 3.81437068582281*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xxM", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{3.667148578266035*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.1875`"},
     {
      RowBox[{"-", "0.333333`"}], "0.`", "0.020833325000000003`"},
     {
      RowBox[{"-", "0.333333`"}], "0.`", "0.08333325`"},
     {
      RowBox[{"-", "0.666667`"}], "0.`", "0.10416675000000002`"},
     {
      RowBox[{"-", "0.666667`"}], "0.`", "0.16666675`"},
     {
      RowBox[{"-", "0.166667`"}], "0.5`", "0.10416675000000002`"},
     {
      RowBox[{"-", "0.166667`"}], "0.5`", "0.16666675`"},
     {
      RowBox[{"-", "0.5`"}], "0.5`", "0.`"},
     {
      RowBox[{"-", "0.5`"}], "0.5`", "0.1875`"},
     {
      RowBox[{"-", "0.833333`"}], "0.5`", "0.020833325000000003`"},
     {
      RowBox[{"-", "0.833333`"}], "0.5`", "0.08333325`"},
     {"0.`", "0.`", "0.25`"},
     {"0.`", "0.`", "0.4375`"},
     {
      RowBox[{"-", "0.333333`"}], "0.`", "0.27083332500000007`"},
     {
      RowBox[{"-", "0.333333`"}], "0.`", "0.33333325`"},
     {
      RowBox[{"-", "0.666667`"}], "0.`", "0.35416675`"},
     {
      RowBox[{"-", "0.666667`"}], "0.`", "0.41666675000000003`"},
     {
      RowBox[{"-", "0.166667`"}], "0.5`", "0.35416675`"},
     {
      RowBox[{"-", "0.166667`"}], "0.5`", "0.41666675000000003`"},
     {
      RowBox[{"-", "0.5`"}], "0.5`", "0.25`"},
     {
      RowBox[{"-", "0.5`"}], "0.5`", "0.4375`"},
     {
      RowBox[{"-", "0.833333`"}], "0.5`", "0.27083332500000007`"},
     {
      RowBox[{"-", "0.833333`"}], "0.5`", "0.33333325`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.667148578834525*^9, 3.6671486092480645`*^9}, 
   3.6671488357586703`*^9, 3.667151691306927*^9, 3.6738525373479676`*^9, 
   3.6738815126910257`*^9, 3.6742815783643036`*^9, 3.6742817125522356`*^9, 
   3.674281772955638*^9, 3.6742818121292534`*^9, 3.674281867813136*^9, 
   3.6742819127548327`*^9, {3.6742819970737286`*^9, 3.6742820216454954`*^9}, 
   3.674282070595804*^9, 3.674282244632261*^9, 3.67428228712651*^9, {
   3.674285805425624*^9, 3.674285816274642*^9}, 3.6742927936489215`*^9, 
   3.674292910586277*^9, 3.8143706858504553`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"out", "=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", "\"\<sigma\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"Anew", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"Anew", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"Anew", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Si\>\"", ",", "\"\<Ga\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "xxP", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "xxM", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", "\"\<Direct\>\"", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667148895840127*^9, 3.6671490310638714`*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.6671489523328886`*^9, {3.667149022611432*^9, 3.6671490313265414`*^9}, 
   3.66715169132257*^9, 3.673852537363572*^9, 3.673881515880992*^9, 
   3.674281579333069*^9, 3.6742817134272585`*^9, 3.674281772971263*^9, 
   3.6742818121292534`*^9, 3.674281867828725*^9, 3.6742819127704782`*^9, {
   3.67428199708936*^9, 3.6742820216611195`*^9}, 3.674282070611457*^9, 
   3.674282244647882*^9, 3.6742822871421337`*^9, {3.6742858054416475`*^9, 
   3.6742858162876186`*^9}, 3.6742927936649323`*^9, 3.6742929106017885`*^9, 
   3.814370685876773*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<sigmaTmp.dat\>\"", ",", 
   RowBox[{"Join", "[", 
    RowBox[{"out", ",", "xxP", ",", "xxM"}], "]"}], ",", "\"\<Data\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6671490430967402`*^9, 3.6671490912797995`*^9}}],

Cell[BoxData["\<\"sigmaTmp.dat\"\>"], "Output",
 CellChangeTimes->{{3.6671490505916986`*^9, 3.6671490916372538`*^9}, 
   3.6671516913538213`*^9, 3.673852537941763*^9, 3.6738815168499174`*^9, 
   3.674281580489315*^9, 3.6742817148178873`*^9, 3.674281773002513*^9, 
   3.674281812160514*^9, 3.674281867859976*^9, 3.674281912786083*^9, {
   3.6742819971049614`*^9, 3.6742820216923685`*^9}, 3.674282070627042*^9, 
   3.6742822446791315`*^9, 3.67428228715777*^9, {3.67428580547266*^9, 
   3.6742858163196306`*^9}, 3.67429279370146*^9, 3.674292910635312*^9, 
   3.814370686035363*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Alpha]", "=", 
  RowBox[{"2.70156", " ", "2"}]}]], "Input",
 CellChangeTimes->{{3.6671492504972615`*^9, 3.6671492532331567`*^9}}],

Cell[BoxData["5.40312`"], "Output",
 CellChangeTimes->{
  3.667149253561227*^9, 3.6671516913694305`*^9, 3.67385253795733*^9, 
   3.6742815816455994`*^9, 3.674281773018139*^9, 3.6742818121761293`*^9, 
   3.674281867875621*^9, 3.674281912801719*^9, {3.674281997120586*^9, 
   3.6742820216923685`*^9}, 3.6742820706427045`*^9, 3.6742822446947565`*^9, 
   3.6742822871733837`*^9, {3.674285805484665*^9, 3.6742858163316383`*^9}, 
   3.674292793716468*^9, 3.6742929106458197`*^9, 3.814370686059659*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["A"], "Input",
 CellChangeTimes->{{3.6671492056043496`*^9, 3.6671492068706264`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"6.61744351`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "3.820582792`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "9.358478359`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.667149207192551*^9, 3.6671516913850713`*^9, 3.6738525379729557`*^9, 
   3.6742815823955956`*^9, 3.674281773033766*^9, 3.6742818121917706`*^9, 
   3.674281867875621*^9, 3.674281912801719*^9, {3.6742819971362133`*^9, 
   3.6742820217080097`*^9}, 3.6742820706583047`*^9, 3.6742822446947565`*^9, 
   3.6742822871890097`*^9, {3.6742858054966736`*^9, 3.6742858163406453`*^9}, 
   3.674292793732479*^9, 3.6742929106573286`*^9, 3.8143706860630083`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/", "\[Alpha]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], "/", "\[Alpha]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "[", 
   RowBox[{"[", "3", "]"}], "]"}], "/", "\[Alpha]"}]}], "Input",
 CellChangeTimes->{{3.6671492329507217`*^9, 3.6671492842794657`*^9}}],

Cell[BoxData["1.2247448714816622`"], "Output",
 CellChangeTimes->{{3.667149238899802*^9, 3.6671492846544495`*^9}, 
   3.6671516914006805`*^9, 3.6738525379885836`*^9, 3.6742815830987253`*^9, 
   3.674281773033766*^9, 3.6742818121917706`*^9, 3.674281867891226*^9, 
   3.6742819128173437`*^9, {3.6742819971362133`*^9, 3.6742820217080097`*^9}, 
   3.6742820706583047`*^9, 3.6742822447103834`*^9, 3.6742822871890097`*^9, {
   3.6742858055076838`*^9, 3.674285816351653*^9}, 3.674292793745989*^9, 
   3.6742929106710806`*^9, 3.814370686066575*^9}],

Cell[BoxData["0.7071067812671197`"], "Output",
 CellChangeTimes->{{3.667149238899802*^9, 3.6671492846544495`*^9}, 
   3.6671516914006805`*^9, 3.6738525379885836`*^9, 3.6742815830987253`*^9, 
   3.674281773033766*^9, 3.6742818121917706`*^9, 3.674281867891226*^9, 
   3.6742819128173437`*^9, {3.6742819971362133`*^9, 3.6742820217080097`*^9}, 
   3.6742820706583047`*^9, 3.6742822447103834`*^9, 3.6742822871890097`*^9, {
   3.6742858055076838`*^9, 3.674285816351653*^9}, 3.674292793745989*^9, 
   3.6742929106710806`*^9, 3.814370686067418*^9}],

Cell[BoxData["1.7320508074964092`"], "Output",
 CellChangeTimes->{{3.667149238899802*^9, 3.6671492846544495`*^9}, 
   3.6671516914006805`*^9, 3.6738525379885836`*^9, 3.6742815830987253`*^9, 
   3.674281773033766*^9, 3.6742818121917706`*^9, 3.674281867891226*^9, 
   3.6742819128173437`*^9, {3.6742819971362133`*^9, 3.6742820217080097`*^9}, 
   3.6742820706583047`*^9, 3.6742822447103834`*^9, 3.6742822871890097`*^9, {
   3.6742858055076838`*^9, 3.674285816351653*^9}, 3.674292793745989*^9, 
   3.6742929106710806`*^9, 3.814370686068222*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"n1", ",", "n2", ",", "k1", ",", "k2"}], "]"}]], "Input",
 CellChangeTimes->{{3.6671516138472548`*^9, 3.667151636913756*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n1", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"Sqrt", "[", "6", "]"}], "2"], ",", "0"}], "}"}]}], "+", 
       RowBox[{"n2", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Sqrt", "[", "3", "]"}]}], "}"}]}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k1", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"Sqrt", "[", "6", "]"}], "2"], ",", "0"}], "}"}]}], "+", 
       RowBox[{"k2", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Sqrt", "[", "3", "]"}]}], "}"}]}]}], ")"}]}], "\[Equal]", 
    "0"}], ",", "k1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6671495270154333`*^9, 3.6671496018386927`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"k1", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", "k2", " ", "n2"}], "n1"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6671495812725945`*^9, 3.6671496024992943`*^9}, {
   3.6671496354783473`*^9, 3.6671496648007097`*^9}, {3.667149712455329*^9, 
   3.667149717045126*^9}, 3.667151639043256*^9, 3.6671516914319468`*^9, 
   3.6738525380979586`*^9, 3.6742815850362797`*^9, 3.674281773065014*^9, 
   3.674281812223024*^9, 3.6742818679068675`*^9, 3.67428191283296*^9, {
   3.674281997151837*^9, 3.6742820217392683`*^9}, 3.6742820706895356`*^9, 
   3.6742822447416534`*^9, 3.6742822872202625`*^9, {3.6742858055357304`*^9, 
   3.6742858163766713`*^9}, 3.674292793776512*^9, 3.6742929107020855`*^9, 
   3.8143706860945883`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"n1", "=", "4"}], "\[IndentingNewLine]", 
 RowBox[{"n2", "=", "5"}], "\[IndentingNewLine]", 
 RowBox[{"k2", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"k1", "=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "k2", " ", "n2"}], "n1"]}]}], "\[IndentingNewLine]", 
 RowBox[{"Anew", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"n1", " ", 
      RowBox[{"A", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "+", 
     RowBox[{"n2", " ", 
      RowBox[{"A", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
    RowBox[{"A", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"4", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"A", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"A", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6671497069094563`*^9, 3.6671497750862217`*^9}, {
   3.6671516431048827`*^9, 3.6671516602789774`*^9}, {3.667152452951586*^9, 
   3.667152491166848*^9}, 3.673852623855936*^9, 3.6738526683715415`*^9, 
   3.6742817702207193`*^9, 3.674281810196472*^9, {3.6742818596348515`*^9, 
   3.674281866016232*^9}, 3.674285801725994*^9, {3.674292787327173*^9, 
   3.6742927895229855`*^9}, 3.6742929083217125`*^9}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.667149715085139*^9, {3.667149763155863*^9, 3.6671497754262133`*^9}, 
   3.6671516611874743`*^9, 3.6671516914475718`*^9, {3.6671524824314146`*^9, 
   3.667152491893235*^9}, 3.673852538129238*^9, 3.673852624637166*^9, 
   3.6738526690885353`*^9, 3.674281586551895*^9, 3.6742817730806417`*^9, 
   3.674281812223024*^9, 3.6742818679224787`*^9, 3.674281912848584*^9, {
   3.674281997167463*^9, 3.6742820217392683`*^9}, 3.674282070705162*^9, 
   3.6742822447416534`*^9, 3.6742822872202625`*^9, {3.674285802151311*^9, 
   3.674285816385676*^9}, 3.6742927937855163`*^9, 3.6742929107116113`*^9, 
   3.814370686118969*^9}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{
  3.667149715085139*^9, {3.667149763155863*^9, 3.6671497754262133`*^9}, 
   3.6671516611874743`*^9, 3.6671516914475718`*^9, {3.6671524824314146`*^9, 
   3.667152491893235*^9}, 3.673852538129238*^9, 3.673852624637166*^9, 
   3.6738526690885353`*^9, 3.674281586551895*^9, 3.6742817730806417`*^9, 
   3.674281812223024*^9, 3.6742818679224787`*^9, 3.674281912848584*^9, {
   3.674281997167463*^9, 3.6742820217392683`*^9}, 3.674282070705162*^9, 
   3.6742822447416534`*^9, 3.6742822872202625`*^9, {3.674285802151311*^9, 
   3.674285816385676*^9}, 3.6742927937855163`*^9, 3.6742929107116113`*^9, 
   3.814370686119746*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.667149715085139*^9, {3.667149763155863*^9, 3.6671497754262133`*^9}, 
   3.6671516611874743`*^9, 3.6671516914475718`*^9, {3.6671524824314146`*^9, 
   3.667152491893235*^9}, 3.673852538129238*^9, 3.673852624637166*^9, 
   3.6738526690885353`*^9, 3.674281586551895*^9, 3.6742817730806417`*^9, 
   3.674281812223024*^9, 3.6742818679224787`*^9, 3.674281912848584*^9, {
   3.674281997167463*^9, 3.6742820217392683`*^9}, 3.674282070705162*^9, 
   3.6742822447416534`*^9, 3.6742822872202625`*^9, {3.674285802151311*^9, 
   3.674285816385676*^9}, 3.6742927937855163`*^9, 3.6742929107116113`*^9, 
   3.8143706861204567`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["5", "2"]}]], "Output",
 CellChangeTimes->{
  3.667149715085139*^9, {3.667149763155863*^9, 3.6671497754262133`*^9}, 
   3.6671516611874743`*^9, 3.6671516914475718`*^9, {3.6671524824314146`*^9, 
   3.667152491893235*^9}, 3.673852538129238*^9, 3.673852624637166*^9, 
   3.6738526690885353`*^9, 3.674281586551895*^9, 3.6742817730806417`*^9, 
   3.674281812223024*^9, 3.6742818679224787`*^9, 3.674281912848584*^9, {
   3.674281997167463*^9, 3.6742820217392683`*^9}, 3.674282070705162*^9, 
   3.6742822447416534`*^9, 3.6742822872202625`*^9, {3.674285802151311*^9, 
   3.674285816385676*^9}, 3.6742927937855163`*^9, 3.6742929107116113`*^9, 
   3.814370686121175*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"26.46977404`", ",", "0.`", ",", "46.792391795`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "3.820582792`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "66.1744351`"}], ",", "0.`", ",", "37.433913436`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.667149715085139*^9, {3.667149763155863*^9, 3.6671497754262133`*^9}, 
   3.6671516611874743`*^9, 3.6671516914475718`*^9, {3.6671524824314146`*^9, 
   3.667152491893235*^9}, 3.673852538129238*^9, 3.673852624637166*^9, 
   3.6738526690885353`*^9, 3.674281586551895*^9, 3.6742817730806417`*^9, 
   3.674281812223024*^9, 3.6742818679224787`*^9, 3.674281912848584*^9, {
   3.674281997167463*^9, 3.6742820217392683`*^9}, 3.674282070705162*^9, 
   3.6742822447416534`*^9, 3.6742822872202625`*^9, {3.674285802151311*^9, 
   3.674285816385676*^9}, 3.6742927937855163`*^9, 3.6742929107116113`*^9, 
   3.8143706861219597`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"delta", "=", "0.0"}]], "Input",
 CellChangeTimes->{{3.674281991948703*^9, 3.674281994401865*^9}, 
   3.674282067720808*^9, {3.6742822218209662`*^9, 3.674282242522914*^9}, 
   3.6742822852983656`*^9, {3.6742858135335665`*^9, 3.674285813820733*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.6742819971831026`*^9, 3.674282021754888*^9}, 
   3.6742820707208033`*^9, 3.6742822447728853`*^9, 3.6742822872359056`*^9, {
   3.674285805571744*^9, 3.674285816412695*^9}, 3.6742927938155394`*^9, 
   3.674292910739766*^9, 3.8143706861253347`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xxP", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xxM", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"ix", "=", 
    RowBox[{"-", "15"}]}], ",", 
   RowBox[{"ix", "\[LessEqual]", "15"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"iz", "=", 
       RowBox[{"-", "15"}]}], ",", 
      RowBox[{"iz", "\[LessEqual]", "15"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "numAtoms1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xP", "[", "i", "]"}], "+", 
              RowBox[{"{", 
               RowBox[{"ix", ",", "0", ",", "iz"}], "}"}]}], ")"}], ".", 
            "A"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmpInv", "=", 
           RowBox[{"tmp", ".", 
            RowBox[{"Inverse", "[", "Anew", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.5"}], "\[LessEqual]", 
              RowBox[{"tmpInv", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", "0.5"}], "&&", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "0.5"}], "-", "delta"}], "\[LessEqual]", 
              RowBox[{"tmpInv", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "<", 
              RowBox[{"0", "-", "delta"}]}]}], ",", 
            RowBox[{"xxP", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"xxP", ",", "tmpInv"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xM", "[", "i", "]"}], "+", 
              RowBox[{"{", 
               RowBox[{"ix", ",", "0", ",", "iz"}], "}"}]}], ")"}], ".", 
            "A"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmpInv", "=", 
           RowBox[{"tmp", ".", 
            RowBox[{"Inverse", "[", "Anew", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.5"}], "\[LessEqual]", 
              RowBox[{"tmpInv", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", "0.5"}], "&&", 
             RowBox[{
              RowBox[{"-", "delta"}], "\[LessEqual]", 
              RowBox[{"tmpInv", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "<", 
              RowBox[{"0.5", "-", "delta"}]}]}], ",", 
            RowBox[{"xxM", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"xxM", ",", "tmpInv"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"iz", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ix", "++"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6671497893220005`*^9, 3.6671498495641108`*^9}, {
   3.6671500656311398`*^9, 3.6671500712664843`*^9}, {3.6671502827473745`*^9, 
   3.6671503050443687`*^9}, {3.6671508899671555`*^9, 3.667150896954376*^9}, {
   3.667151123045978*^9, 3.667151123951013*^9}, {3.6671525124933915`*^9, 
   3.667152516005946*^9}, 3.6742819104266853`*^9, {3.674282016067353*^9, 
   3.6742820186611395`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dimensions", "[", "xxP", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "xxM", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"396", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.6671498387633467`*^9, 3.6671498506643543`*^9}, {
   3.667150090479288*^9, 3.6671501160194874`*^9}, {3.6671502972425504`*^9, 
   3.667150312272949*^9}, 3.667150923112248*^9, 3.667151125380804*^9, {
   3.6671516637215223`*^9, 3.6671516915257*^9}, {3.6671524938816767`*^9, 
   3.6671525174251103`*^9}, 3.6738525387073545`*^9, 3.6738526267934484`*^9, 
   3.6738526705416794`*^9, 3.674281590415293*^9, 3.674281773540097*^9, 
   3.674281812598008*^9, 3.6742818682974963`*^9, 3.6742819132315826`*^9, {
   3.674281997558093*^9, 3.674282022129876*^9}, 3.6742820710957923`*^9, 
   3.6742822451496983`*^9, 3.6742822876265345`*^9, {3.674285806004033*^9, 
   3.674285816841016*^9}, 3.674292794266879*^9, 3.6742929111685886`*^9, 
   3.814370686579459*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"396", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.6671498387633467`*^9, 3.6671498506643543`*^9}, {
   3.667150090479288*^9, 3.6671501160194874`*^9}, {3.6671502972425504`*^9, 
   3.667150312272949*^9}, 3.667150923112248*^9, 3.667151125380804*^9, {
   3.6671516637215223`*^9, 3.6671516915257*^9}, {3.6671524938816767`*^9, 
   3.6671525174251103`*^9}, 3.6738525387073545`*^9, 3.6738526267934484`*^9, 
   3.6738526705416794`*^9, 3.674281590415293*^9, 3.674281773540097*^9, 
   3.674281812598008*^9, 3.6742818682974963`*^9, 3.6742819132315826`*^9, {
   3.674281997558093*^9, 3.674282022129876*^9}, 3.6742820710957923`*^9, 
   3.6742822451496983`*^9, 3.6742822876265345`*^9, {3.674285806004033*^9, 
   3.674285816841016*^9}, 3.674292794266879*^9, 3.6742929111685886`*^9, 
   3.8143706865802794`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["numAtoms1"], "Input"],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{
  3.667149883616561*^9, 3.66715031335607*^9, 3.667150924487259*^9, 
   3.6671511268717127`*^9, {3.6671516649226522`*^9, 3.667151691541328*^9}, {
   3.667152499760378*^9, 3.667152518565734*^9}, 3.673852538722972*^9, 
   3.6738526279809628`*^9, 3.673852671166669*^9, 3.6742815916184177`*^9, 
   3.674281773552104*^9, 3.674281812613654*^9, 3.674281868313106*^9, 
   3.6742819132315826`*^9, {3.674281997573733*^9, 3.6742820221454988`*^9}, 
   3.674282071111416*^9, 3.6742822451496983`*^9, 3.6742822876265345`*^9, {
   3.674285806017044*^9, 3.67428581685301*^9}, 3.6742927942808704`*^9, 
   3.6742929111835833`*^9, 3.814370686583508*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"6", " ", 
   RowBox[{
    RowBox[{"Det", "[", "Anew", "]"}], "/", 
    RowBox[{"Det", "[", "A", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6671498525900154`*^9, 3.6671498948984346`*^9}, {
  3.667151668471754*^9, 3.6671516687313757`*^9}}],

Cell[BoxData["396.0000000000001`"], "Output",
 CellChangeTimes->{{3.6671498611777024`*^9, 3.667149895291622*^9}, 
   3.667150314088092*^9, 3.6671509251903863`*^9, 3.667151127562114*^9, {
   3.667151665750808*^9, 3.6671516915569315`*^9}, {3.667152500777377*^9, 
   3.6671525193157425`*^9}, 3.6738525387385902`*^9, 3.6738526286215944`*^9, 
   3.673852671713569*^9, 3.6742815923059244`*^9, 3.6742817735641127`*^9, 
   3.6742818126292763`*^9, 3.674281868328735*^9, 3.674281913247207*^9, {
   3.6742819975893526`*^9, 3.6742820221611457`*^9}, 3.6742820711270523`*^9, 
   3.6742822451653423`*^9, 3.6742822876421413`*^9, {3.674285806029052*^9, 
   3.674285816862034*^9}, 3.674292794290876*^9, 3.674292911193602*^9, 
   3.8143706865869102`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"out", "=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", "\"\<sigma\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"Anew", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"Anew", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"Anew", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Si\>\"", ",", "\"\<Ga\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "xxP", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "xxM", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"out", ",", 
     RowBox[{"{", "\"\<Direct\>\"", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<sigmaTmp.dat\>\"", ",", 
   RowBox[{"Join", "[", 
    RowBox[{"out", ",", "xxP", ",", "xxM"}], "]"}], ",", "\"\<Data\>\""}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6671499343654747`*^9, 3.6671499345839643`*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.6671499354748487`*^9, 3.6671503148003435`*^9, 3.667150925956026*^9, 
   3.6671511291871357`*^9, {3.6671516706532774`*^9, 3.667151691572565*^9}, 
   3.667152519862626*^9, 3.673852538754218*^9, 3.673852629293478*^9, 
   3.673852672229201*^9, 3.6742815932903137`*^9, 3.6742817735731215`*^9, 
   3.6742818126292763`*^9, 3.674281868328735*^9, 3.674281913262817*^9, {
   3.674281997604968*^9, 3.6742820221611457`*^9}, 3.6742820711270523`*^9, 
   3.6742822451809473`*^9, 3.674282287657778*^9, {3.6742858060380583`*^9, 
   3.6742858168720217`*^9}, 3.6742927943038874`*^9, 3.6742929112085977`*^9, 
   3.8143706865908318`*^9}],

Cell[BoxData["\<\"sigmaTmp.dat\"\>"], "Output",
 CellChangeTimes->{
  3.6671499354748487`*^9, 3.6671503148003435`*^9, 3.667150925956026*^9, 
   3.6671511291871357`*^9, {3.6671516706532774`*^9, 3.667151691572565*^9}, 
   3.667152519862626*^9, 3.673852538754218*^9, 3.673852629293478*^9, 
   3.673852672229201*^9, 3.6742815932903137`*^9, 3.6742817735731215`*^9, 
   3.6742818126292763`*^9, 3.674281868328735*^9, 3.674281913262817*^9, {
   3.674281997604968*^9, 3.6742820221611457`*^9}, 3.6742820711270523`*^9, 
   3.6742822451809473`*^9, 3.674282287657778*^9, {3.6742858060380583`*^9, 
   3.6742858168720217`*^9}, 3.6742927943038874`*^9, 3.6742929112085977`*^9, 
   3.8143706866229153`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6672272825808506`*^9, 3.6672272911761675`*^9}, 
   3.814370714266108*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"DeleteFile", "::", "nffil"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"File not found during \
\[NoBreak]\\!\\(DeleteFile[\\\"sigmaTmp.vasp\\\"]\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/nffil\\\", \
ButtonNote -> \\\"DeleteFile::nffil\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.814370686716485*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.814370686718405*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.667227177219658*^9, 3.6672272041264224`*^9}, {
   3.66722727341185*^9, 3.6672272763705797`*^9}, 3.814370722428637*^9}],

Cell[BoxData["\<\"/home/users/alamman4/Desktop/Mathematicacoll/sigmaTmp.vasp\"\
\>"], "Output",
 CellChangeTimes->{{3.667227192754921*^9, 3.6672272174766283`*^9}, {
   3.667227269367734*^9, 3.667227322638691*^9}, 3.6672273708599634`*^9, 
   3.667227449473077*^9, 3.6672275281467924`*^9, 3.6672275776337852`*^9, 
   3.667227637644761*^9, 3.6672276751777334`*^9, {3.6672277475545835`*^9, 
   3.667227781262573*^9}, {3.6672278249513187`*^9, 3.667227843604074*^9}, 
   3.6672278754759855`*^9, 3.667227916357276*^9, 3.667228029728178*^9, 
   3.667228079791664*^9, 3.6672281340183697`*^9, 3.6742816165963173`*^9, 
   3.6742817736193323`*^9, 3.674281812691761*^9, 3.6742818683756075`*^9, 
   3.6742819132940655`*^9, {3.674281997651843*^9, 3.6742820222080417`*^9}, 
   3.674282071173917*^9, 3.6742822452278233`*^9, 3.6742822876890163`*^9, {
   3.6742858060941*^9, 3.6742858169260645`*^9}, 3.6742927943689337`*^9, 
   3.674292911311181*^9, 3.81437068679046*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.674282043199193*^9, 3.6742820592150564`*^9}, {
   3.674290576678386*^9, 3.6742905768346367`*^9}, 3.814370725580511*^9}],

Cell[BoxData["76.02863760411634`"], "Output",
 CellChangeTimes->{{3.6742820507930403`*^9, 3.67428207118956*^9}, 
   3.6742822452278233`*^9, 3.6742822877046404`*^9, {3.6742858061031237`*^9, 
   3.674285816936084*^9}, 3.6742905772252064`*^9, 3.67429279438196*^9, 
   3.674292911323679*^9, 3.814370686814501*^9}]
}, Open  ]]
},
WindowSize->{1914, 964},
WindowMargins->{{Automatic, 0}, {Automatic, 24}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 191, 5, 30, "Input"],
Cell[774, 29, 580, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1391, 42, 140, 2, 30, "Input"],
Cell[1534, 46, 588, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2159, 59, 3067, 87, 392, "Input"],
Cell[5229, 148, 572, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5838, 161, 829, 27, 30, "Input"],
Cell[6670, 190, 845, 17, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7552, 212, 395, 12, 30, "Input"],
Cell[7950, 226, 869, 18, 30, "Output"]
}, Open  ]],
Cell[8834, 247, 2303, 64, 221, "Input"],
Cell[CellGroupData[{
Cell[11162, 315, 201, 3, 50, "Input"],
Cell[11366, 320, 704, 11, 30, "Output"],
Cell[12073, 333, 704, 11, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12814, 349, 128, 2, 30, "Input"],
Cell[12945, 353, 2647, 71, 409, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15629, 429, 103, 2, 30, "Input"],
Cell[15735, 433, 2558, 67, 409, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18330, 505, 1820, 57, 183, "Input"],
Cell[20153, 564, 606, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20796, 579, 268, 6, 30, "Input"],
Cell[21067, 587, 578, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21682, 600, 155, 3, 30, "Input"],
Cell[21840, 605, 495, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22372, 617, 97, 1, 30, "Input"],
Cell[22472, 620, 776, 16, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23285, 641, 560, 16, 69, "Input"],
Cell[23848, 659, 540, 7, 30, "Output"],
Cell[24391, 668, 540, 7, 30, "Output"],
Cell[24934, 677, 540, 7, 30, "Output"]
}, Open  ]],
Cell[25489, 687, 173, 3, 30, "Input"],
Cell[CellGroupData[{
Cell[25687, 694, 867, 28, 54, "Input"],
Cell[26557, 724, 809, 15, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27403, 744, 1327, 34, 134, "Input"],
Cell[28733, 780, 665, 10, 30, "Output"],
Cell[29401, 792, 665, 10, 30, "Output"],
Cell[30069, 804, 667, 10, 30, "Output"],
Cell[30739, 816, 703, 12, 47, "Output"],
Cell[31445, 830, 989, 20, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32471, 855, 271, 4, 30, "Input"],
Cell[32745, 861, 298, 4, 30, "Output"]
}, Open  ]],
Cell[33058, 868, 3599, 90, 278, "Input"],
Cell[CellGroupData[{
Cell[36682, 962, 133, 2, 50, "Input"],
Cell[36818, 966, 839, 13, 30, "Output"],
Cell[37660, 981, 841, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38538, 999, 35, 0, 30, "Input"],
Cell[38576, 1001, 682, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39295, 1016, 279, 7, 30, "Input"],
Cell[39577, 1025, 735, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40349, 1040, 2024, 63, 202, "Input"],
Cell[42376, 1105, 686, 11, 30, "Output"],
Cell[43065, 1118, 688, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43790, 1133, 122, 2, 30, "Input"],
Cell[43915, 1137, 476, 10, 24, "Message"],
Cell[44394, 1149, 76, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44507, 1155, 167, 2, 30, "Input"],
Cell[44677, 1159, 952, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45666, 1177, 168, 2, 30, "Input"],
Cell[45837, 1181, 309, 4, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
